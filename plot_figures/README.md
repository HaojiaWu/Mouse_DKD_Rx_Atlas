# Scripts to reproduce the figures in our manuscript

## 1. figure2.R
#### The R script is for reproducing the figure2 in our manuscript. We wrapped the codes into two functions in our R package plot1cell (https://github.com/HaojiaWu/plot1cell) to help users who want to generate a similar circlize graph for their own dataset. Simply install the package and here is the example to generate the graph:
```
devtools::install_github("HaojiaWu/plot1cell")
library(plot1cell)
data_plot<-prepare_circlize_data(seurat_obj)
plot_circlize(data_plot)
add_track(data_plot, group = 'disease') ### change the 'disease' to whatever column name in your metadata
```
## 2. figure3.R
#### The dotplot graph in figure3 can also be easily generated by plot1cell:
```
library(plot1cell)
genelist<-c("gene1", "gene2"...."geneN")
complex_dotplot_multiple(seu_obj = seu, features = genelist, groupby = "disease") ### change the 'disease' to whatever column name in your metadata
```
## 3. figure4.R
#### Script to reproduce figure4

## 4. figure5.R
#### Script to reproduce figure5

## 5. figure6.R
#### Script to reproduce figure6. To use plot1cell and generate the upset plot for your own data, please try:
library(plot1cell)
plot_upset(deg_table = deg_df)

## 6. figure7.R
#### Script to reproduce figure7. If using plot1cell for your own data, please follow the command lines below:
```
library(plot1cell)
modified_dimplot(seu_obj = seu, label.box = F, title = "")
complex_vlnplot_single(seu = seu, cell.types = c("S1","S2"), groups = 'disease')
```
